<Page x:Class="GymManagementSystem.Views.Pages.BiometricPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      Title="Biometric">
    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
            <TextBlock Text="Biometric Device Management" FontSize="28" FontWeight="Bold" VerticalAlignment="Center"/>
            <Button x:Name="btnAddDevice" 
                    Content="ADD DEVICE" 
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Margin="20,0,0,0"
                    Height="40"
                    Click="btnAddDevice_Click"/>
        </StackPanel>

        <!-- Devices DataGrid -->
        <materialDesign:Card Grid.Row="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <DataGrid x:Name="dgDevices" 
                          Grid.Row="0"
                          AutoGenerateColumns="False" 
                          IsReadOnly="True"
                          CanUserAddRows="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding DeviceId}" Width="60"/>
                        <DataGridTextColumn Header="Device Name" Binding="{Binding DeviceName}" Width="*"/>
                        <DataGridTextColumn Header="IP Address" Binding="{Binding IPAddress}" Width="150"/>
                        <DataGridTextColumn Header="Port" Binding="{Binding Port}" Width="80"/>
                        <DataGridTextColumn Header="Type" Binding="{Binding DeviceType}" Width="100"/>
                        <DataGridTextColumn Header="Status" Binding="{Binding StatusDisplay}" Width="120"/>
                        <DataGridTextColumn Header="Last Connected" Binding="{Binding LastConnectedDate, StringFormat=dd/MM/yyyy HH:mm}" Width="150"/>
                        <DataGridTemplateColumn Header="Actions" Width="250">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Button Content="Test" 
                                                Style="{StaticResource MaterialDesignFlatButton}"
                                                Tag="{Binding DeviceId}"
                                                Click="btnTest_Click"
                                                Foreground="Blue"
                                                Margin="0,0,5,0"/>
                                        <Button Content="Enroll" 
                                                Style="{StaticResource MaterialDesignFlatButton}"
                                                Tag="{Binding DeviceId}"
                                                Click="btnEnroll_Click"
                                                Foreground="Green"
                                                Margin="5,0,5,0"/>
                                        <Button Content="Edit" 
                                                Style="{StaticResource MaterialDesignFlatButton}"
                                                Tag="{Binding DeviceId}"
                                                Click="btnEdit_Click"
                                                Margin="5,0,0,0"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- Info Panel -->
                <Border Grid.Row="1" Background="#E3F2FD" Padding="15" BorderBrush="#2196F3" BorderThickness="0,1,0,0">
                    <StackPanel>
                        <TextBlock Text="ℹ️ Biometric Device Integration" FontWeight="Bold" FontSize="14" Margin="0,0,0,5"/>
                        <TextBlock Text="• Supports Hikvision fingerprint terminals" FontSize="12" Margin="0,2"/>
                        <TextBlock Text="• Test connection before enrolling fingerprints" FontSize="12" Margin="0,2"/>
                        <TextBlock Text="• Enroll member fingerprints for automatic attendance tracking" FontSize="12" Margin="0,2"/>
                        <TextBlock Text="• Requires Hikvision SDK (HCNetSDK.dll) - Place in application directory" FontSize="12" Margin="0,2" Foreground="OrangeRed"/>
                    </StackPanel>
                </Border>
            </Grid>
        </materialDesign:Card>
    </Grid>
</Page>
