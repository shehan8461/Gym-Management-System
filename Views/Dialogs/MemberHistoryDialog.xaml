<Window x:Class="GymManagementSystem.Views.Dialogs.MemberHistoryDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Member History" 
        Height="700" 
        Width="900"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Member Info Header -->
        <materialDesign:Card Grid.Row="0" Margin="0,0,0,15" Padding="20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock x:Name="txtMemberName" 
                               Text="Member Name" 
                               FontSize="24" 
                               FontWeight="Bold" 
                               Foreground="#00BFA5"/>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <TextBlock Text="ID: " FontWeight="SemiBold"/>
                        <TextBlock x:Name="txtMemberId" Text=""/>
                        <TextBlock Text="  |  Phone: " FontWeight="SemiBold" Margin="15,0,0,0"/>
                        <TextBlock x:Name="txtPhone" Text=""/>
                        <TextBlock Text="  |  Registration: " FontWeight="SemiBold" Margin="15,0,0,0"/>
                        <TextBlock x:Name="txtRegistrationDate" Text=""/>
                    </StackPanel>
                </StackPanel>
                
                <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                    <TextBlock x:Name="txtPaymentStatus" 
                               Text="Status" 
                               FontSize="16" 
                               FontWeight="Bold" 
                               HorizontalAlignment="Right"/>
                </StackPanel>
            </Grid>
        </materialDesign:Card>

        <!-- Package & Payment Info -->
        <materialDesign:Card Grid.Row="1" Margin="0,0,0,15" Padding="20" Background="#F5F5F5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Current Package" 
                               FontSize="12" 
                               FontWeight="SemiBold" 
                               Foreground="Gray"/>
                    <TextBlock x:Name="txtCurrentPackage" 
                               Text="No Package" 
                               FontSize="18" 
                               FontWeight="Bold" 
                               Foreground="#9C27B0"
                               Margin="0,5,0,0"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1">
                    <TextBlock Text="Next Payment Due" 
                               FontSize="12" 
                               FontWeight="SemiBold" 
                               Foreground="Gray"/>
                    <TextBlock x:Name="txtNextDueDate" 
                               Text="N/A" 
                               FontSize="18" 
                               FontWeight="Bold" 
                               Foreground="#FF6F00"
                               Margin="0,5,0,0"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2">
                    <TextBlock Text="Package End Date" 
                               FontSize="12" 
                               FontWeight="SemiBold" 
                               Foreground="Gray"/>
                    <TextBlock x:Name="txtPackageEndDate" 
                               Text="N/A" 
                               FontSize="18" 
                               FontWeight="Bold" 
                               Foreground="#D32F2F"
                               Margin="0,5,0,0"/>
                </StackPanel>
            </Grid>
        </materialDesign:Card>

        <!-- Payment History -->
        <materialDesign:Card Grid.Row="2">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <Border Grid.Row="0" 
                        Background="#00BFA5" 
                        Padding="15">
                    <TextBlock Text="Payment History" 
                               FontSize="16" 
                               FontWeight="Bold" 
                               Foreground="White"/>
                </Border>
                
                <DataGrid x:Name="dgPaymentHistory" 
                          Grid.Row="1"
                          AutoGenerateColumns="False" 
                          IsReadOnly="True"
                          CanUserAddRows="False"
                          Margin="10">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Payment ID" Binding="{Binding PaymentId}" Width="80"/>
                        <DataGridTextColumn Header="Package" Binding="{Binding MembershipPackage.PackageName}" Width="150"/>
                        <DataGridTextColumn Header="Amount" Binding="{Binding Amount, StringFormat=Rs. {0:N2}}" Width="120">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Foreground" Value="Green"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Payment Date" Binding="{Binding PaymentDate, StringFormat=dd/MM/yyyy}" Width="120"/>
                        <DataGridTextColumn Header="Start Date" Binding="{Binding StartDate, StringFormat=dd/MM/yyyy}" Width="110"/>
                        <DataGridTextColumn Header="End Date" Binding="{Binding EndDate, StringFormat=dd/MM/yyyy}" Width="110"/>
                        <DataGridTextColumn Header="Method" Binding="{Binding PaymentMethod}" Width="80"/>
                        <DataGridTextColumn Header="Remarks" Binding="{Binding Remarks}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
                
                <!-- Payment Summary -->
                <Border Grid.Row="2" 
                        Background="#E3F2FD" 
                        Padding="15" 
                        BorderBrush="#2196F3" 
                        BorderThickness="0,1,0,0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <TextBlock Text="Total Payments: " FontWeight="SemiBold" FontSize="14"/>
                            <TextBlock x:Name="txtTotalPayments" Text="0" FontSize="14" Margin="5,0,0,0"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="20,0,0,0">
                            <TextBlock Text="Last Payment: " FontWeight="SemiBold" FontSize="14"/>
                            <TextBlock x:Name="txtLastPaymentDate" Text="N/A" FontSize="14" Margin="5,0,0,0"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="20,0,0,0">
                            <TextBlock Text="Total Amount: " FontWeight="SemiBold" FontSize="14"/>
                            <TextBlock x:Name="txtTotalAmount" 
                                       Text="Rs. 0.00" 
                                       FontSize="14" 
                                       FontWeight="Bold" 
                                       Foreground="Green" 
                                       Margin="5,0,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </materialDesign:Card>

        <!-- Close Button -->
        <Button Grid.Row="3" 
                Content="CLOSE" 
                Style="{StaticResource MaterialDesignFlatButton}"
                HorizontalAlignment="Right"
                Margin="0,15,0,0"
                MinWidth="100"
                Height="40"
                Click="btnClose_Click"/>
    </Grid>
</Window>
